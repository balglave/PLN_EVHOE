knitr::opts_chunk$set(echo = TRUE)
load("data/EVHOE_2008_2019.RData")
Save_Datras$datras_HH.full
Save_Datras$datras_HH.full
Save_Datras$datras_sp.CA.full
full_join(HH_df,CA_df)
library(tidyr)
load("data/EVHOE_2008_2019.RData")
HH_df <- Save_Datras$datras_HH.full
CA_df <- Save_Datras$datras_sp.CA.full
full_join(HH_df,CA_df)
library(dplyr)
full_join(HH_df,CA_df)
CA_df
Save_Datras$datras_sp.CA.full$NoAtALK
unique(Save_Datras$datras_sp.CA.full$NoAtALK)
install.packages("PLNmodels")
library(PLNmodels)
data(oaks)
data(oaks)
library(PLNmodels)
data(oaks)
data_catch.nbr_sp.as.column <- function(data_survey.nbr){
## delete duplicated data
data_survey.nbr <- data_survey.nbr[!duplicated(data_survey.nbr),]
data_survey.nbr %>%
dplyr::select("Survey",
"StNo",
"HaulNo",
"Year",
"Stratum",
"Distance",
"HaulNo",
"scientificname",
"Sex",
"CatIdentifier",
"TotalNo",
"lati",
"long") %>%
mutate(scientificname = paste("TotalNo_",scientificname,sep='')) -> tmp
# create toto to save caracteristics of the hauls
tmp %>% dplyr::select(-c(TotalNo,scientificname,CatIdentifier,Sex)) -> toto
# take only 1st data row for each haul : others are duplicates
toto %>% group_by(HaulNo,Year) %>% slice(1) -> toto
# species as columns
tmp %>%
group_by(scientificname,HaulNo,Year) %>%
dplyr :: summarise(TotalNo = sum(as.numeric(TotalNo))) %>%
spread(key= scientificname, value = TotalNo) -> tmp
tmp <- full_join(toto,tmp, by = c("HaulNo","Year"))
tmp[is.na(tmp)] <- 0
return(tmp)
}
# Catch at size (data key: per haul, species, length class, sex, maturity, age)
HL_df <- Save_Datras$datras_sp.HL.full
Survey.data_catch_nbr <- data_catch.nbr_sp.as.column(HL_df)
Survey.data_catch_nbr$Year
unique(Survey.data_catch_nbr$Year)
head(Survey.data_catch_nbr)
View(Survey.data_catch_nbr)
?select_at
